<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تقارير الأداء | نظام إدارة المسوقين العقاريين</title>
    
    <!-- فونت Tajawal -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- مكتبة FontAwesome للأيقونات -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- البوتستراب - الإطار الأساسي -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- مكتبة Chart.js للرسوم البيانية -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.css">
    
    <!-- أوراق الأنماط المخصصة -->
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="../assets/css/dark-theme.css">
    <link rel="stylesheet" href="assets/css/analytics-styles.css">
</head>
<body>
    <div class="wrapper">
        <!-- شريط التنقل الجانبي -->
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="../assets/images/logo.png" alt="شعار النظام" class="logo-img">
                    <h3 class="logo-text">عقارك</h3>
                </div>
                <button class="d-md-none toggle-sidebar" id="closeSidebar"><i class="fa fa-times"></i></button>
            </div>
            
            <div class="sidebar-menu">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link" href="../dashboard.html">
                            <i class="fas fa-tachometer-alt menu-icon"></i>
                            <span class="menu-text">الرئيسية</span>
                        </a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="analytics-dashboard.html">
                            <i class="fas fa-chart-line menu-icon"></i>
                            <span class="menu-text">التحليلات</span>
                        </a>
                        <ul class="submenu">
                            <li><a href="analytics-dashboard.html">لوحة التحكم التحليلية</a></li>
                            <li><a href="performance-reports.html" class="active">تقارير الأداء</a></li>
                            <li><a href="kpi-monitoring.html">مؤشرات الأداء</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../ads/ads-management.html">
                            <i class="fas fa-ad menu-icon"></i>
                            <span class="menu-text">إدارة الإعلانات</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../videos/videos-gallery.html">
                            <i class="fas fa-video menu-icon"></i>
                            <span class="menu-text">معرض الفيديوهات</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../crm/customer-list.html">
                            <i class="fas fa-users menu-icon"></i>
                            <span class="menu-text">إدارة العملاء</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../schedule/calendar-view.html">
                            <i class="fas fa-calendar-alt menu-icon"></i>
                            <span class="menu-text">جدولة المواعيد</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../commissions/commission-dashboard.html">
                            <i class="fas fa-money-bill-wave menu-icon"></i>
                            <span class="menu-text">العمولات والمدفوعات</span>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
        
        <!-- المحتوى الرئيسي -->
        <div id="content" class="content">
            <!-- شريط التنقل العلوي -->
            <nav class="navbar navbar-expand-lg">
                <div class="container-fluid">
                    <button id="sidebarToggle" class="navbar-toggler d-lg-none" type="button">
                        <i class="fas fa-bars"></i>
                    </button>
                    
                    <div class="d-flex align-items-center ms-auto">
                        <div class="theme-switch-wrapper">
                            <label class="theme-switch" for="themeToggle">
                                <input type="checkbox" id="themeToggle">
                                <div class="slider round">
                                    <i class="fas fa-sun light-icon"></i>
                                    <i class="fas fa-moon dark-icon"></i>
                                </div>
                            </label>
                        </div>
                        
                        <div class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <img src="../assets/images/avatar.png" class="user-avatar" alt="صورة المستخدم">
                                <span class="d-none d-lg-inline ms-1">أحمد محمد</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                                <li><a class="dropdown-item" href="../profile.html"><i class="fas fa-user me-2"></i> الملف الشخصي</a></li>
                                <li><a class="dropdown-item" href="../settings.html"><i class="fas fa-cog me-2"></i> الإعدادات</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="../login.html"><i class="fas fa-sign-out-alt me-2"></i> تسجيل الخروج</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </nav>
            
            <!-- محتوى الصفحة -->
            <div class="container-fluid">
                <div class="page-header">
                    <h1 class="page-title">تقارير الأداء التفصيلية</h1>
                    <p class="page-subtitle">تقارير مفصلة عن أداء المبيعات والتسويق والعملاء</p>
                </div>
                
                <!-- فلاتر التقارير -->
                <div class="analytics-card">
                    <div class="analytics-filters">
                        <div class="filter-item">
                            <label class="filter-label">نوع التقرير</label>
                            <select class="form-select" id="reportTypeFilter">
                                <option value="sales">تقرير المبيعات</option>
                                <option value="marketing">تقرير التسويق</option>
                                <option value="customer">تقرير العملاء</option>
                                <option value="agent">تقرير أداء الوكلاء</option>
                                <option value="conversion">تقرير معدلات التحويل</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label class="filter-label">الفترة الزمنية</label>
                            <select class="form-select" id="periodFilter">
                                <option value="lastWeek">الأسبوع الماضي</option>
                                <option value="lastMonth">الشهر الماضي</option>
                                <option value="lastQuarter">الربع الأخير</option>
                                <option value="lastYear" selected>السنة الماضية</option>
                                <option value="custom">فترة مخصصة</option>
                            </select>
                        </div>
                        <div class="filter-item" id="customDateContainer" style="display: none;">
                            <label class="filter-label">نطاق التاريخ</label>
                            <div class="date-range-picker">
                                <input type="date" class="form-control" id="startDate">
                                <input type="date" class="form-control" id="endDate">
                            </div>
                        </div>
                        <div class="filter-item ms-auto">
                            <button class="btn btn-primary" id="generateReport">
                                <i class="fas fa-file-export"></i> إنشاء التقرير
                            </button>
                        </div>
                        <div class="filter-item">
                            <div class="btn-group">
                                <button class="btn btn-outline-secondary" id="printReport">
                                    <i class="fas fa-print"></i> طباعة
                                </button>
                                <button class="btn btn-outline-secondary" id="exportPDF">
                                    <i class="fas fa-file-pdf"></i> PDF
                                </button>
                                <button class="btn btn-outline-secondary" id="exportExcel">
                                    <i class="fas fa-file-excel"></i> Excel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- نتائج التقرير -->
                <div id="reportContainer">
                    <!-- سيتم تحميل محتوى التقرير هنا -->
                    <div class="text-center p-5">
                        <div class="mb-4">
                            <i class="fas fa-chart-pie fa-3x text-muted"></i>
                        </div>
                        <h3>اختر نوع التقرير والفترة الزمنية</h3>
                        <p class="text-muted">ثم انقر على زر "إنشاء التقرير" للبدء</p>
                    </div>
                </div>
                
                <!-- أقسام التقارير المختلفة (سيتم إظهارها حسب اختيار المستخدم) -->
                <div class="report-sections" style="display: none;">
                    <!-- تقرير المبيعات -->
                    <div id="salesReport" class="report-section">
                        <div class="section-header mt-4">
                            <h2 class="section-title">تقرير المبيعات التفصيلي</h2>
                            <p class="section-subtitle">تحليل أداء المبيعات خلال الفترة المحددة</p>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 col-lg-3">
                                <div class="analytics-card info-card">
                                    <div class="info-title">إجمالي المبيعات</div>
                                    <div class="info-value">12,450,000 ريال</div>
                                    <div class="info-description">زيادة 15% عن الفترة السابقة</div>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-3">
                                <div class="analytics-card info-card">
                                    <div class="info-title">عدد الصفقات</div>
                                    <div class="info-value">112</div>
                                    <div class="info-description">زيادة 8% عن الفترة السابقة</div>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-3">
                                <div class="analytics-card info-card">
                                    <div class="info-title">متوسط قيمة الصفقة</div>
                                    <div class="info-value">111,161 ريال</div>
                                    <div class="info-description">زيادة 6% عن الفترة السابقة</div>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-3">
                                <div class="analytics-card info-card">
                                    <div class="info-title">معدل إتمام الصفقات</div>
                                    <div class="info-value">24%</div>
                                    <div class="info-description">زيادة 2% عن الفترة السابقة</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-lg-8">
                                <div class="analytics-card chart-card">
                                    <div class="card-header">
                                        <h3 class="card-title">توزيع المبيعات حسب الشهر</h3>
                                    </div>
                                    <div class="chart-container">
                                        <canvas id="salesByMonthChart"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="analytics-card chart-card">
                                    <div class="card-header">
                                        <h3 class="card-title">توزيع المبيعات حسب نوع العقار</h3>
                                    </div>
                                    <div class="chart-container">
                                        <canvas id="salesByPropertyTypeChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="analytics-card mt-4">
                            <div class="card-header">
                                <h3 class="card-title">تفاصيل الصفقات</h3>
                            </div>
                            <div class="table-responsive">
                                <table class="analytics-table">
                                    <thead>
                                        <tr>
                                            <th>رقم الصفقة</th>
                                            <th>العميل</th>
                                            <th>نوع العقار</th>
                                            <th>المنطقة</th>
                                            <th>قيمة الصفقة</th>
                                            <th>تاريخ الإتمام</th>
                                            <th>الوكيل المسؤول</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>S-2025-0112</td>
                                            <td>محمد عبدالله</td>
                                            <td>شقة</td>
                                            <td>الرياض - النرجس</td>
                                            <td>850,000 ريال</td>
                                            <td>15 فبراير 2025</td>
                                            <td>عمر السعيد</td>
                                        </tr>
                                        <tr>
                                            <td>S-2025-0111</td>
                                            <td>فهد العلي</td>
                                            <td>فيلا</td>
                                            <td>الرياض - الملقا</td>
                                            <td>2,500,000 ريال</td>
                                            <td>10 فبراير 2025</td>
                                            <td>خالد القحطاني</td>
                                        </tr>
                                        <tr>
                                            <td>S-2025-0110</td>
                                            <td>شركة نماء للاستثمار</td>
                                            <td>أرض تجارية</td>
                                            <td>جدة - الروضة</td>
                                            <td>4,200,000 ريال</td>
                                            <td>5 فبراير 2025</td>
                                            <td>عبدالرحمن الشمري</td>
                                        </tr>
                                        <tr>
                                            <td>S-2025-0109</td>
                                            <td>سعود الحربي</td>
                                            <td>شقة</td>
                                            <td>الدمام - الشاطئ</td>
                                            <td>750,000 ريال</td>
                                            <td>1 فبراير 2025</td>
                                            <td>عمر السعيد</td>
                                        </tr>
                                        <tr>
                                            <td>S-2025-0108</td>
                                            <td>نورة الشهري</td>
                                            <td>فيلا</td>
                                            <td>الرياض - حطين</td>
                                            <td>3,100,000 ريال</td>
                                            <td>29 يناير 2025</td>
                                            <td>خالد القحطاني</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="text-center pt-3">
                                <button class="btn btn-link">عرض المزيد من الصفقات</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- تذييل الصفحة -->
            <footer class="footer">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-6">
                            <p class="copyright">جميع الحقوق محفوظة &copy; 2025</p>
                        </div>
                        <div class="col-md-6">
                            <div class="footer-links">
                                <a href="#">سياسة الخصوصية</a>
                                <a href="#">شروط الاستخدام</a>
                                <a href="#">اتصل بنا</a>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    
    <!-- سكريبت جافاسكريبت -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    
    <!-- السكريبتات المخصصة -->
    <script src="../assets/js/theme-toggle.js"></script>
    <script src="../assets/js/sidebar-toggle.js"></script>
    <script src="assets/js/analytics-data.js"></script>
    <script src="assets/js/analytics-charts.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // عرض/إخفاء خيار التاريخ المخصص
            document.getElementById('periodFilter').addEventListener('change', function() {
                const customDateContainer = document.getElementById('customDateContainer');
                customDateContainer.style.display = this.value === 'custom' ? 'block' : 'none';
            });
            
            // معالجة إنشاء التقرير
            document.getElementById('generateReport').addEventListener('click', function() {
                const reportType = document.getElementById('reportTypeFilter').value;
                const reportContainer = document.getElementById('reportContainer');
                const reportSections = document.querySelector('.report-sections');
                
                // إظهار قسم التقرير المناسب حسب النوع المختار
                reportContainer.innerHTML = '';
                reportSections.style.display = 'block';
                
                // في الإصدار الحقيقي سيتم تحميل بيانات التقرير ديناميكيًا
                // لكن هنا سنعرض مثال ثابت فقط
                const salesReport = document.getElementById('salesReport');
                salesReport.style.display = reportType === 'sales' ? 'block' : 'none';
                
                // إنشاء رسوم بيانية للتقرير
                if (reportType === 'sales') {
                    // رسم بياني للمبيعات الشهرية
                    const salesByMonthCtx = document.getElementById('salesByMonthChart').getContext('2d');
                    new Chart(salesByMonthCtx, {
                        type: 'bar',
                        data: {
                            labels: ['يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو', 'يوليو', 'أغسطس', 'سبتمبر', 'أكتوبر', 'نوفمبر', 'ديسمبر'],
                            datasets: [{
                                label: 'قيمة المبيعات (بالألف ريال)',
                                data: [850, 920, 1100, 980, 1250, 1300, 1450, 1200, 1350, 1500, 1600, 1700],
                                backgroundColor: 'rgba(94, 114, 228, 0.7)',
                                borderColor: 'rgba(94, 114, 228, 1)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        font: {
                                            family: "'Tajawal', sans-serif"
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        font: {
                                            family: "'Tajawal', sans-serif"
                                        }
                                    }
                                },
                                x: {
                                    ticks: {
                                        font: {
                                            family: "'Tajawal', sans-serif"
                                        }
                                    }
                                }
                            }
                        }
                    });
                    
                    // رسم بياني لتوزيع المبيعات حسب نوع العقار
                    const salesByPropertyTypeCtx = document.getElementById('salesByPropertyTypeChart').getContext('2d');
                    new Chart(salesByPropertyTypeCtx, {
                        type: 'pie',
                        data: {
                            labels: ['شقق', 'فلل', 'أراضي', 'عقارات تجارية', 'مكاتب'],
                            datasets: [{
                                data: [35, 25, 15, 20, 5],
                                backgroundColor: [
                                    'rgba(94, 114, 228, 0.7)',
                                    'rgba(45, 206, 137, 0.7)',
                                    'rgba(251, 99, 64, 0.7)',
                                    'rgba(17, 205, 239, 0.7)',
                                    'rgba(253, 235, 95, 0.7)'
                                ],
                                borderColor: [
                                    'rgba(94, 114, 228, 1)',
                                    'rgba(45, 206, 137, 1)',
                                    'rgba(251, 99, 64, 1)',
                                    'rgba(17, 205, 239, 1)',
                                    'rgba(253, 235, 95, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        font: {
                                            family: "'Tajawal', sans-serif"
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
            });
            
            // معالجة الطباعة والتصدير
            document.getElementById('printReport').addEventListener('click', function() {
                window.print();
            });
            
            document.getElementById('exportPDF').addEventListener('click', function() {
                alert('سيتم تصدير التقرير بصيغة PDF');
                // في الإصدار الحقيقي، سيتم تنفيذ هذه الوظيفة لتصدير بيانات التقرير إلى PDF
            });
            
            document.getElementById('exportExcel').addEventListener('click', function() {
                alert('سيتم تصدير التقرير بصيغة Excel');
                // في الإصدار الحقيقي، سيتم تنفيذ هذه الوظيفة لتصدير بيانات التقرير إلى Excel
            });
        });
    </script>
</body>
</html>
